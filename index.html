<!DOCTYPE html>
<html>
  <head>
    <title>Memory exercise</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

	<style>
		.memoryboard {
			background-color: #CCC; 
			
		}

		.memoryboard > div {
			width: 71px; 
			height: 71px; 
		}

		.flipped { 
			background-color: white !important; 
		}

		.tile {
			display: inline-block; 
			background-color: black; 
			margin: 10px; 
		}
	</style>

  </head>
  <body>
	  <h1>memory</h1>
	<div class = "memoryboard">
	</div>
  	<div class = "msg"> pick a card</div>
  	
  	<script>	
  	var Tile = function(text) {
		this.text = text 
		this.div =  $("<div class=\"tile\"><span>" + this.text +"</span></div>");

		this.genHTML(this.div)
		
		var self = this 		
		this.div.click(function(){
			self.handleClick();
		})
	}

	Tile.prototype.handleClick = function() {
		
		this.flip(); 
		scoreBoard.push(this)				


		if (scoreBoard.length < 2) {
			console.log("waiting for other click")
			return; 
		}
		
		tile1 = scoreBoard[0],
		tile2 = scoreBoard[1]


		if (tile1.matches(tile2)){
				msg("matched") 
				scoreBoard = []
		} else {
				msg("try again")
				scoreBoard = []; 
			return  
		} 
			
	}

	Tile.prototype.genHTML = function(div) {
		$(".memoryboard").append(div);
	}	

	Tile.prototype.flip = function() {
		console.log("flipped")
		this.div.addClass("flipped")
	}

	Tile.prototype.unflip = function() {
		this.div.removeClass("flipped")
	}

	Tile.prototype.matches = function(otherTile) {
		if(this.text == otherTile.text){	
			self = this
			setTimeout(function() {
				self.div.css("visibility", "hidden")
				otherTile.div.css("visibility", "hidden")
				console.log("matches")
			}, 1000)
			return true
		}else{
			setTimeout(function(){
				tile1.unflip() 
				tile2.unflip()
			}, 1000);
			return false; 
		}
	}

	var msg = function(msg) {
		$(".msg").text(msg)
	}
	
	//global variables
	
	scoreBoard = []

  	$(document).ready(function(){
	
		var tilesNames = ["A", "A", "B", "B", "C", "C"]	

		for (i=0; i < tilesNames.length; i++) {			
		
			// x = Math.random()
			// y = x * (tilesNames.length - 1 )
			// z = Math.floor(y)
			// console.log(z)

			var text = tilesNames[i]
			
			var tile = new Tile(text); 
			
		}			
		

	});


  	</script>
  </body>
</html>
